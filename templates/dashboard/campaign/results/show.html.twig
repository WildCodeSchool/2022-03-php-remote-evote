{% extends '/dashboard/base.html.twig' %}

{% block body %}
    <div class="container-result">
            {# <div class="align-items-center mb-4">
			<a class="btn btn-primary ms-auto" href="#">
				Télécharger au format xls
			</button>
			<a class="btn btn-primary ms-auto" href="#">
				Envoyer les résultats aux votants
			</button>
			</div> #}
            <div class="mb-4">
                {% if campaign.company is not null %}
                    <h1>Résultats des votes de {{ campaign.company.name }}</h1>
                    <h2><span class="badge bg-primary">{{ campaign.name }}</span></h2>
                {% endif %}
            </div>

        <div class="mb-4">
            <p>Ouverture le
                <strong>{{ campaign.createdAt|date('l d F à H:i:s') }}</strong>
            </p>
            <p>Fermeture le
                <strong>{{ campaign.endedAt|date('l d F à H:i:s') }}</strong>
            </p>

            {% for resolution in resolutions %}
                <div class="mb-4">
                    <h3 class="bg-secondary text-white p-2">{{ resolution.name }}</h3>
                    <p>{{ resolution.description }}</p>
                    {% if campaign.hasCollege %}
                        <div class="text-center">
                            <h4>Résultats par collèges</h4>
                            <div class="row">
                                {% for vote in resolution.voteResults %}
                                    <div class="col-lg-3 mx-auto">
                                        {% if vote.numApproved == 0 and vote.numRejected == 0 and vote.numAbstention == 0 %}
                                            Aucun vote effectué pour le moment
                                        {% else %}
                                        {{ render_chart(vote.chart) }}
                                        {% endif %}
                                        <div class=" mt-3">
                                            <h5>{{ vote.college.name }}</h5>
                                            <p>Part des votes : {{ vote.college.votePercentage * 100 }} %</p>
                                        </div>
                                    </div>
                                {% else %}
                                    <div class="col">
                                        Aucun vote effectué pour le moment
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% else %}
                        <div class="row text-center">
                            <h4>Résultats par votants</h4>
                            {% for vote in resolution.voteResults %}
                                <div class="col-lg-3 mx-auto">
                                    {{ render_chart(vote.chart) }}
                                </div>
                            {% else %}
                                <div class="col">
                                    Aucun vote effectué pour le moment
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {{resolution.finalResult.message}}
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
